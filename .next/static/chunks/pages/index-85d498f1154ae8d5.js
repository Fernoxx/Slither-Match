(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(88407)}])},88407:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return c}});var s=t(85893),a=t(67294),i=t(20583),l=t(22225),r=t(15554);let d=[{inputs:[{internalType:"uint256",name:"_entryFee",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"lobbyId",type:"uint256"},{indexed:!0,internalType:"address",name:"winner",type:"address"}],name:"GameEnded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"lobbyId",type:"uint256"}],name:"LobbyActivated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"lobbyId",type:"uint256"}],name:"LobbyCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"lobbyId",type:"uint256"},{indexed:!0,internalType:"address",name:"player",type:"address"}],name:"PlayerJoined",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"lobbyId",type:"uint256"},{indexed:!0,internalType:"address",name:"player",type:"address"}],name:"RefundIssued",type:"event"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"},{internalType:"address",name:"_winner",type:"address"}],name:"endGame",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"entryFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"}],name:"getLobbyState",outputs:[{internalType:"enum SlitherMatch.LobbyState",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"}],name:"getPlayers",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"}],name:"joinLobby",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"lobbyCounter",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"}],name:"markRefundable",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_lobbyId",type:"uint256"}],name:"refund",outputs:[],stateMutability:"nonpayable",type:"function"}],u="0xdE5aC11A48f6bAaCd45b6907D4701979743Bf08c";function c(){let{address:e,isConnected:n}=(0,i.m)(),[t,c]=(0,a.useState)(1),[o,m]=(0,a.useState)([]),[p,y]=(0,a.useState)(null),[b,x]=(0,a.useState)(null),[h,f]=(0,a.useState)(!1),[j,N]=(0,a.useState)(Date.now()),{data:v,refetch:g}=(0,l.u)({address:u,abi:d,functionName:"getPlayers",args:[t]}),{writeContract:w}=(0,r.S)(),{writeContract:D}=(0,r.S)(),{writeContract:T}=(0,r.S)();return(0,a.useEffect)(()=>{v&&m(v)},[v]),(0,a.useEffect)(()=>{let e=setInterval(()=>N(Date.now()),1e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{if(3===o.length&&null!==p){let e=setInterval(()=>{let n=3e4-(Date.now()-p);n<=0?(clearInterval(e),x(null)):x(Math.floor(n/1e3))},1e3);return()=>clearInterval(e)}x(null)},[o,p]),(0,a.useEffect)(()=>{p&&Date.now()-p>=3e5&&o.length<3?f(!0):f(!1)},[j,p,o]),(0,s.jsx)("div",{className:"game-container min-h-screen p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"lobby-title",children:"SlitherMatch"}),(0,s.jsxs)("p",{className:"text-purple-700 text-lg font-semibold",children:["Lobby ID: ",(0,s.jsx)("span",{className:"text-purple-900",children:t})]})]}),(0,s.jsx)("div",{className:"game-board p-8 mb-6",children:(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsxs)("div",{className:"inline-flex items-center justify-center space-x-2 mb-4",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded-full"}),(0,s.jsxs)("span",{className:"text-xl font-bold text-purple-800",children:["Players: ",o.length," / 5"]}),(0,s.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded-full"})]}),(0,s.jsxs)("div",{className:"space-y-2 mb-6",children:[o.map((e,n)=>(0,s.jsx)("div",{className:"player-info",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:n+1}),(0,s.jsxs)("span",{className:"text-purple-800 font-medium truncate",children:[e.slice(0,6),"...",e.slice(-4)]})]}),(0,s.jsx)("div",{className:"text-green-600 font-semibold",children:"✓ Ready"})]})},n)),Array.from({length:5-o.length},(e,n)=>(0,s.jsx)("div",{className:"player-info opacity-50",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-500 font-bold",children:o.length+n+1}),(0,s.jsx)("span",{className:"text-gray-500 font-medium",children:"Waiting for player..."})]})},"empty-".concat(n)))]}),null!==b&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,s.jsxs)("div",{className:"countdown-text",children:["\uD83C\uDFAE Game starts in: ",b,"s"]})}),(0,s.jsx)("button",{className:"game-button text-lg px-8 py-4 mb-4",onClick:()=>{w({address:u,abi:d,functionName:"joinLobby",args:[t],value:BigInt(1e15)}),y(Date.now())},children:"\uD83D\uDE80 Join Lobby"}),h&&(0,s.jsxs)("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,s.jsx)("div",{className:"text-red-700 font-semibold mb-3",children:"⚠️ Lobby inactive for 5+ minutes. You can claim a refund."}),(0,s.jsx)("button",{className:"refund-button",onClick:()=>{D({address:u,abi:d,functionName:"markRefundable",args:[t]}),T({address:u,abi:d,functionName:"refund",args:[t]})},children:"\uD83D\uDCB0 Claim Refund"})]})]})}),(0,s.jsxs)("div",{className:"game-rules",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-purple-800 mb-4 text-center",children:"Game Rules"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"\uD83D\uDD34"}),(0,s.jsx)("span",{children:"Red dots = 3 points"})]}),(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"\uD83D\uDFE2"}),(0,s.jsx)("span",{children:"Green dots = 6 points"})]}),(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"\uD83D\uDFE3"}),(0,s.jsx)("span",{children:"Purple dots = 12 points"})]}),(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"⏰"}),(0,s.jsx)("span",{children:"Game lasts 3 minutes max"})]}),(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"\uD83C\uDFC6"}),(0,s.jsx)("span",{children:"Winner: Last alive OR highest score"})]}),(0,s.jsxs)("div",{className:"rule-item",children:[(0,s.jsx)("span",{className:"rule-emoji",children:"\uD83D\uDCB0"}),(0,s.jsx)("span",{children:"Winner takes 100% of entry fees"})]})]})]}),(0,s.jsx)("div",{className:"text-center mt-6",children:(0,s.jsxs)("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-white/80 rounded-full border border-purple-200",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(n?"bg-green-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-sm font-medium text-purple-800",children:n?"Connected: ".concat(null==e?void 0:e.slice(0,6),"...").concat(null==e?void 0:e.slice(-4)):"Not Connected"})]})})]})})}}},function(e){e.O(0,[626,899,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);